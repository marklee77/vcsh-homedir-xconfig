#!/bin/bash
scriptname="$(basename $0)"

errfile="${HOME}/.local/var/log/${scriptname}.err"
exec 2>${errfile}

rundir="${HOME}/.local/var/run/mailsync"
if ls ${rundir}/*.error >/dev/null 2>/dev/null; then
    echo -e " \uf132: mail sync error"
    exit 33
fi

lockdir="${HOME}/.local/var/lock/mailsync"
pidfile="${lockdir}/PID"
otherpid=$(cat ${pidfile} 2>/dev/null)
othercmd=$(ps --no-headers --format command --pid ${otherpid})
if [[ "${othercmd}" =~ .*mailsync.* ]]; then
    echo -e "\uf021\uf132"
fi

exit 0
